<!DOCTYPE html>
<html>
<head>
    <title>URLå¤„ç†æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
        .result { background: #f8f9fa; border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 4px; }
        .error { background: #f8d7da; border-color: #dc3545; }
        .success { background: #d4edda; border-color: #28a745; }
    </style>
</head>
<body>
    <h1>ğŸ”§ WebDAV URLå¤„ç†æµ‹è¯•</h1>
    
    <button onclick="testURL()">æµ‹è¯•å½“å‰ç¯å¢ƒURLå¤„ç†</button>
    <div id="result" class="result">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
    
    <script>
        function testURL() {
            const result = document.getElementById('result');
            
            // æ£€æµ‹ç¯å¢ƒ
            const isVercel = window.location.hostname.includes('vercel.app');
            const isDev = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
            
            // æ¨¡æ‹ŸgetProcessedUrlå‡½æ•°
            function getProcessedUrl(originalUrl) {
                if (isVercel && originalUrl.includes('dav.jianguoyun.com')) {
                    return '/api/webdav';
                }
                if (isDev && originalUrl.includes('dav.jianguoyun.com')) {
                    return '/webdav';
                }
                return originalUrl;
            }
            
            // æµ‹è¯•å„ç§URL
            const tests = [
                'https://dav.jianguoyun.com/dav/',
                'https://dav.jianguoyun.com/dav/EBooks/',
                'https://dav.jianguoyun.com/dav/EBooks/test.md'
            ];
            
            let output = `ç¯å¢ƒæ£€æµ‹ç»“æœ:\n`;
            output += `- å½“å‰åŸŸå: ${window.location.hostname}\n`;
            output += `- æ˜¯å¦Vercel: ${isVercel}\n`;
            output += `- æ˜¯å¦å¼€å‘ç¯å¢ƒ: ${isDev}\n\n`;
            
            output += `URLå¤„ç†ç»“æœ:\n`;
            tests.forEach(url => {
                const processed = getProcessedUrl(url);
                output += `- ${url} â†’ ${processed}\n`;
            });
            
            output += `\né¢„æœŸè¡Œä¸º:\n`;
            if (isVercel) {
                output += `- æ‰€æœ‰åšæœäº‘URLéƒ½åº”è¯¥è½¬æ¢ä¸º /api/webdav\n`;
                output += `- WebDAVåº“ä¼šåœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ å…·ä½“è·¯å¾„\n`;
                output += `- ä¾‹å¦‚: /api/webdav/EBooks/ (è€Œä¸æ˜¯ /dav/EBooks/)\n`;
            } else if (isDev) {
                output += `- æ‰€æœ‰åšæœäº‘URLéƒ½åº”è¯¥è½¬æ¢ä¸º /webdav\n`;
            } else {
                output += `- ä¿æŒåŸå§‹URLä¸å˜\n`;
            }
            
            result.textContent = output;
            result.className = 'result success';
        }
    </script>
</body>
</html>
