<!DOCTYPE html>
<html>
<head>
    <title>APIå“åº”è°ƒè¯•</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
        button { background: #007bff; color: white; border: none; padding: 10px 20px; margin: 5px; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .result { background: #f8f9fa; border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 4px; }
        .error { background: #f8d7da; border-color: #dc3545; }
        .success { background: #d4edda; border-color: #28a745; }
        .loading { background: #fff3cd; border-color: #ffc107; }
    </style>
</head>
<body>
    <h1>ğŸ”§ APIå“åº”è°ƒè¯•</h1>
    
    <h3>åŸºç¡€APIæµ‹è¯•</h3>
    <button onclick="testHello()">æµ‹è¯• /api/hello</button>
    <button onclick="testJSON()">æµ‹è¯• /api/test-json</button>
    <button onclick="testPing()">æµ‹è¯• /api/ping</button>
    
    <h3>WebDAVæµ‹è¯•</h3>
    <button onclick="testWebDAVFixed()">æµ‹è¯• /api/webdav-fixed/</button>
    
    <div id="result" class="result">ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•...</div>
    
    <script>
        function showResult(text, type = 'loading') {
            const element = document.getElementById('result');
            element.textContent = text;
            element.className = `result ${type}`;
        }
        
        async function testHello() {
            showResult('æ­£åœ¨æµ‹è¯• /api/hello...', 'loading');
            
            try {
                console.log('å‘é€è¯·æ±‚åˆ° /api/hello');
                const startTime = Date.now();
                
                const response = await fetch('/api/hello', {
                    method: 'GET',
                    headers: {
                        'Accept': 'text/plain'
                    }
                });
                
                const endTime = Date.now();
                console.log('æ”¶åˆ°å“åº”:', response.status, response.statusText);
                
                const text = await response.text();
                console.log('å“åº”å†…å®¹:', text);
                
                showResult(
                    `âœ… /api/hello æµ‹è¯•æˆåŠŸ!\n\n` +
                    `çŠ¶æ€ç : ${response.status}\n` +
                    `å“åº”æ—¶é—´: ${endTime - startTime}ms\n` +
                    `å†…å®¹ç±»å‹: ${response.headers.get('content-type')}\n` +
                    `å“åº”å†…å®¹: ${text}`,
                    'success'
                );
                
            } catch (error) {
                console.error('è¯·æ±‚å¤±è´¥:', error);
                showResult(`âŒ /api/hello æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        async function testJSON() {
            showResult('æ­£åœ¨æµ‹è¯• /api/test-json...', 'loading');
            
            try {
                console.log('å‘é€è¯·æ±‚åˆ° /api/test-json');
                const startTime = Date.now();
                
                const response = await fetch('/api/test-json', {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                
                const endTime = Date.now();
                console.log('æ”¶åˆ°å“åº”:', response.status, response.statusText);
                
                const json = await response.json();
                console.log('å“åº”JSON:', json);
                
                showResult(
                    `âœ… /api/test-json æµ‹è¯•æˆåŠŸ!\n\n` +
                    `çŠ¶æ€ç : ${response.status}\n` +
                    `å“åº”æ—¶é—´: ${endTime - startTime}ms\n` +
                    `å†…å®¹ç±»å‹: ${response.headers.get('content-type')}\n` +
                    `å“åº”æ•°æ®: ${JSON.stringify(json, null, 2)}`,
                    'success'
                );
                
            } catch (error) {
                console.error('è¯·æ±‚å¤±è´¥:', error);
                showResult(`âŒ /api/test-json æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        async function testPing() {
            showResult('æ­£åœ¨æµ‹è¯• /api/ping...', 'loading');
            
            try {
                console.log('å‘é€è¯·æ±‚åˆ° /api/ping');
                const startTime = Date.now();
                
                const response = await fetch('/api/ping');
                const endTime = Date.now();
                console.log('æ”¶åˆ°å“åº”:', response.status, response.statusText);
                
                const json = await response.json();
                console.log('å“åº”JSON:', json);
                
                showResult(
                    `âœ… /api/ping æµ‹è¯•æˆåŠŸ!\n\n` +
                    `çŠ¶æ€ç : ${response.status}\n` +
                    `å“åº”æ—¶é—´: ${endTime - startTime}ms\n` +
                    `å“åº”æ•°æ®: ${JSON.stringify(json, null, 2)}`,
                    'success'
                );
                
            } catch (error) {
                console.error('è¯·æ±‚å¤±è´¥:', error);
                showResult(`âŒ /api/ping æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        async function testWebDAVFixed() {
            showResult('æ­£åœ¨æµ‹è¯• /api/webdav-fixed/...', 'loading');
            
            try {
                console.log('å‘é€è¯·æ±‚åˆ° /api/webdav-fixed/');
                const startTime = Date.now();
                
                const response = await fetch('/api/webdav-fixed/', {
                    method: 'PROPFIND',
                    headers: {
                        'Authorization': 'Basic ' + btoa('test@example.com:test123'),
                        'Depth': '1'
                    }
                });
                
                const endTime = Date.now();
                console.log('æ”¶åˆ°å“åº”:', response.status, response.statusText);
                
                const text = await response.text();
                console.log('å“åº”å†…å®¹é•¿åº¦:', text.length);
                
                showResult(
                    `âœ… /api/webdav-fixed/ æµ‹è¯•å®Œæˆ!\n\n` +
                    `çŠ¶æ€ç : ${response.status}\n` +
                    `å“åº”æ—¶é—´: ${endTime - startTime}ms\n` +
                    `å†…å®¹ç±»å‹: ${response.headers.get('content-type')}\n` +
                    `å“åº”é•¿åº¦: ${text.length} å­—ç¬¦\n` +
                    `å‰200å­—ç¬¦: ${text.substring(0, 200)}`,
                    response.ok ? 'success' : 'error'
                );
                
            } catch (error) {
                console.error('è¯·æ±‚å¤±è´¥:', error);
                showResult(`âŒ /api/webdav-fixed/ æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }
    </script>
</body>
</html>
